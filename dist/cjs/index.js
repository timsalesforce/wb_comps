"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@salesforce/design-system-react"),t=require("react"),n=require("nprogress"),a=require("styled-components"),l=require("@salesforce/design-system-react/components/alert/container");function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=r(t),u=r(n),i=r(a),o=r(l),c=function(){return c=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e},c.apply(this,arguments)};function d(e,t,n,a){return new(n||(n=Promise))((function(l,r){function s(e){try{i(a.next(e))}catch(e){r(e)}}function u(e){try{i(a.throw(e))}catch(e){r(e)}}function i(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}i((a=a.apply(e,t||[])).next())}))}function f(e,t){var n,a,l,r,s={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return r={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function u(r){return function(u){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(l=2&r[0]?a.return:r[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,r[1])).done)return l;switch(a=0,l&&(r=[2&r[0],l.value]),r[0]){case 0:case 1:l=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(l=s.trys,(l=l.length>0&&l[l.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!l||r[1]>l[0]&&r[1]<l[3])){s.label=r[1];break}if(6===r[0]&&s.label<l[1]){s.label=l[1],l=r;break}if(l&&s.label<l[2]){s.label=l[2],s.ops.push(r);break}l[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=l=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,u])}}}function p(e,t,n){if(n||2===arguments.length)for(var a,l=0,r=t.length;l<r;l++)!a&&l in t||(a||(a=Array.prototype.slice.call(t,0,l)),a[l]=t[l]);return e.concat(a||Array.prototype.slice.call(t))}function m(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var b,v,g,h,E,y,S,k,C=i.default.div(b||(b=m(["\n  padding: 1em 0;\n"],["\n  padding: 1em 0;\n"]))),R=function(n){var a=n.setErrorMessage,l=n.setDescribeResponse,r=n.setStatus,i=t.useState(),o=i[0],c=i[1],p=t.useState(),m=p[0],b=p[1],v=t.useState(!1),g=v[0],h=v[1],E=t.useState(!1),y=E[0],S=E[1],k=t.useState(!1),R=k[0],x=k[1],O=t.useState(!1),j=O[0],I=O[1],B=t.useState(!1),T=B[0],w=B[1],_=t.useState(!1),P=_[0],N=_[1],D=t.useState(!1),V=D[0],U=D[1],M=t.useState(!1),A=M[0],L=M[1],F=t.useState(),q=F[0],Q=F[1],G=t.useState("NoTestRun"),W=G[0],H=G[1],z=t.useState(),Z=z[0],J=z[1];t.useEffect((function(){if(o){r("Request pending, checking status again in 5s...");var e=setInterval((function(){u.default.start(),n.sendDeployStatus({id:o,includeDetails:!0,sessionId:n.sid,soapEndpoint:n.soapEndpoint}).then((function(t){t.result.done&&(r(void 0),clearInterval(e),l(t.result))})).catch((function(t){a(t.message),clearInterval(e)})).finally((function(){u.default.done()}))}),5e3)}}),[o]);var X=t.useCallback((function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){return b(e.target.files&&e.target.files[0]||void 0),[2]}))}))}),[]),K=t.useCallback((function(){return d(void 0,void 0,void 0,(function(){var e,t,r;return f(this,(function(s){switch(s.label){case 0:l(void 0),a(""),e={zipFile:m,allowMissingFiles:g,autoUpdatePackage:y,ignoreWarnings:j,checkOnly:R,performRetrieve:T,purgeOnDelete:P,rollbackOnError:V,singlePackage:A,runTests:q,testLevel:W,soapEndpoint:n.soapEndpoint,sessionId:n.sid},s.label=1;case 1:return s.trys.push([1,3,4,5]),u.default.start(),[4,n.sendDeploy(e)];case 2:return t=s.sent(),c(t.result.id),l(t.result),[3,5];case 3:return r=s.sent(),a(r instanceof Error?r.message:r+""),[3,5];case 4:return u.default.done(),n.setObjectName("Deploy"),[7];case 5:return[2]}}))}))}),[m,g,y,j,R,T,P,V,A,q,W]),Y=t.useCallback((function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){return l(void 0),c(void 0),b(void 0),r(void 0),h(!1),S(!1),I(!1),x(!1),w(!1),N(!1),U(!1),L(!1),Q([]),H(""),Z.value="",[2]}))}))}),[Z]);return s.default.createElement("div",null,s.default.createElement(C,null,s.default.createElement("div",{className:"slds-text-title_bold slds-form-element__label"},"File"),s.default.createElement(e.Input,{name:"zipFile",type:"file",inputRef:J,onChange:X})),s.default.createElement(C,null,s.default.createElement("div",{className:"slds-text-title_bold slds-form-element__label"},"Parameters"),s.default.createElement(e.Checkbox,{id:"allowMissingFiles",labels:{label:"Allow Missing Files"},onChange:function(e,t){h(t.checked)},checked:g}),s.default.createElement(e.Checkbox,{id:"autoUpdatePackage",labels:{label:"Auto Update Package"},onChange:function(e,t){S(t.checked)},checked:y}),s.default.createElement(e.Checkbox,{id:"checkOnly",labels:{label:"Check Only"},onChange:function(e,t){x(t.checked)},checked:R}),s.default.createElement(e.Checkbox,{id:"ignoreWarnings",labels:{label:"Ignore Warnings"},onChange:function(e,t){I(t.checked)},checked:j}),s.default.createElement(e.Checkbox,{id:"performRetrieve",labels:{label:"Perform Retrieve"},onChange:function(e,t){w(t.checked)},checked:T}),s.default.createElement(e.Checkbox,{id:"purgeOnDelete",labels:{label:"Purge On Delete"},onChange:function(e,t){N(t.checked)},checked:P}),s.default.createElement(e.Checkbox,{id:"rollbackOnError",labels:{label:"Rollback On Error"},onChange:function(e,t){U(t.checked)},checked:V}),s.default.createElement(e.Checkbox,{id:"singlePackage",labels:{label:"Single Package"},onChange:function(e,t){L(t.checked)},checked:A})),s.default.createElement(C,null,s.default.createElement("div",{className:"slds-text-title_bold slds-form-element__label"},"Testing"),s.default.createElement("div",{style:{display:"flex"}},s.default.createElement(e.RadioGroup,{onChange:function(e){return H(e.target.value)},name:"Test Level",style:{border:0}},s.default.createElement(e.Radio,{id:"NoTestRun",value:"NoTestRun",defaultChecked:"true",labels:{label:"None"}}),s.default.createElement(e.Radio,{id:"RunLocalTests",value:"RunLocalTests",labels:{label:"Run Local"}}),s.default.createElement(e.Radio,{id:"RunAllTestsInOrg",value:"RunAllTestsInOrg",labels:{label:"Run All"}}),s.default.createElement(e.Radio,{id:"RunSpecifiedTests",value:"RunSpecifiedTests",labels:{label:"Run Specified"}}))),W&&"RunSpecifiedTests"===W&&s.default.createElement(e.Input,{type:"text",placeholder:"Run tests (comma separated)",onChange:function(e){return Q(e.target.value.split(","))}})),m&&s.default.createElement(e.Button,{onClick:K},"Deploy"),s.default.createElement(e.Button,{onClick:Y},"Clear"))},x=function(n){var a=t.useState(n.value),l=a[0],r=a[1],u=t.useState([{label:n.value}]),i=u[0],o=u[1];t.useEffect((function(){"boolean"==typeof n.value?o([{label:n.value+""}]):o([{label:n.value}])}),[n.value]);var c=t.useCallback((function(t){return s.default.createElement(e.Combobox,{events:{onSelect:function(e,t){n.onChange(e,n.label,t.selection[0].label),r(""),o(t.selection)}},labels:{label:n.label},value:l,selection:i,align:"left",iconCategory:"utility",iconName:"down",length:"10",iconPosition:"right",variant:"readonly",options:t})}),[n.label,l,i]);return s.default.createElement("div",{key:n.label},"picklist"===n.type&&c(n.options)||"boolean"===n.type&&c([{label:"true"},{label:"false"}])||s.default.createElement(e.Input,{type:"text",value:n.value,label:n.label,disabled:n.disabled,onChange:function(e){return n.onChange(e)}}))},O=i.default.div(v||(v=m(["\n  padding: 1em 0;\n"],["\n  padding: 1em 0;\n"]))),j=function(t){var n=t.index,a=t.setName,l=t.setMembers;return s.default.createElement("div",null,s.default.createElement(e.Input,{type:"text",name:"name",placeholder:"Metadata Type",value:t.name,onChange:function(e){return a(e.target.value,n)}}),s.default.createElement(e.Input,{type:"text",name:"members",placeholder:"Members (comma separated)",value:t.members,onChange:function(e){return l(e.target.value,n)}}))},I=function(n){var a=n.setErrorMessage,l=n.setDescribeResponse,r=n.setStatus,i=t.useState([{name:"",members:[]}]),o=i[0],m=i[1],b=t.useState(),v=b[0],g=b[1],h=t.useState(),E=h[0],y=h[1],S=t.useState(),k=S[0],C=S[1],R=t.useState();R[0];var x=R[1],I=t.useState([]),B=I[0],T=I[1],w=t.useState(!1),_=w[0],P=w[1],N=t.useState("file"),D=N[0],V=N[1],U=t.useState(),M=U[0],A=U[1];t.useEffect((function(){if(v){r("Request pending, checking status again in 5s...");var e=setInterval((function(){u.default.start(),n.sendRetrieveStatus({id:v,includeZip:!1,sessionId:n.sid,soapEndpoint:n.soapEndpoint}).then((function(t){t.result.done&&(r(void 0),clearInterval(e),y(!0),l(t.result))})).catch((function(t){a(t.message),clearInterval(e)})).finally((function(){u.default.done()}))}),5e3)}}),[v]);var L=t.useCallback((function(){return d(void 0,void 0,void 0,(function(){var e;return f(this,(function(t){switch(t.label){case 0:return[4,n.sendRetrieveStatus({id:v,includeZip:!0,sessionId:n.sid,soapEndpoint:n.soapEndpoint})];case 1:return e=t.sent(),C(e.result.zipFile),[2]}}))}))}),[v]),F=t.useCallback((function(){return d(void 0,void 0,void 0,(function(){var e,t;return f(this,(function(r){switch(r.label){case 0:C(void 0),y(!1),l(void 0),r.label=1;case 1:return r.trys.push([1,3,4,5]),u.default.start(),[4,n.sendRetrieve({types:o,packageNames:B,singlePackage:_,sessionId:n.sid,soapEndpoint:n.soapEndpoint,apiVersion:n.apiVersion})];case 2:return e=r.sent(),g(e.result.id),l(e.result),[3,5];case 3:return t=r.sent(),a(t instanceof Error?t.message:t+""),[3,5];case 4:return u.default.done(),n.setObjectName("Retrieve"),[7];case 5:return[2]}}))}))}),[o,B,_]),q=t.useCallback((function(){return d(void 0,void 0,void 0,(function(){var e;return f(this,(function(t){return(e=p([],o,!0)).push({name:"",members:[]}),m(e),[2]}))}))}),[o]),Q=t.useCallback((function(){return d(void 0,void 0,void 0,(function(){var e;return f(this,(function(t){return(e=p([],o,!0)).pop(),m(e),[2]}))}))}),[o]),G=t.useCallback((function(e,t){return d(void 0,void 0,void 0,(function(){var n,a;return f(this,(function(l){return n=p([],o,!0),(a=c({},n[t])).name=e,n.splice(t,1,a),m(n),[2]}))}))}),[o]),W=t.useCallback((function(e,t){return d(void 0,void 0,void 0,(function(){var n,a;return f(this,(function(l){return n=p([],o,!0),(a=c({},n[t])).members=e.split(","),n.splice(t,1,a),m(n),[2]}))}))}),[o,n.soapEndpoint,n.sid,B]),H=t.useCallback((function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){return l(void 0),m([{name:"",members:[]}]),y(!1),g(void 0),C(void 0),r(void 0),x(void 0),M.value="",[2]}))}))}),[M]),z=t.useCallback((function(e){return d(void 0,void 0,void 0,(function(){var t,n,a,l;return f(this,(function(r){switch(r.label){case 0:return e.target.files&&e.target.files.length>0?(x(e.target.files[0]),t=[],[4,e.target.files[0].text()]):[3,2];case 1:return n=r.sent(),a=require("react-xml-parser"),l=(new a).parseFromString(n),l.getElementsByTagName("types").map((function(e){var n=e.getElementsByTagName("name")[0].value,a=e.getElementsByTagName("members").map((function(e){return e.value}));t.push({name:n,members:a})})),m(t),[3,3];case 2:m([]),r.label=3;case 3:return[2]}}))}))}),[]);return s.default.createElement("div",null,s.default.createElement(e.IconSettings,{iconPath:"/assets/icons"},s.default.createElement(O,null,s.default.createElement(e.RadioGroup,{labels:{label:"Choose Input Type"},onChange:function(e){return V(e.target.value)},name:"Type"},s.default.createElement(e.Radio,{id:"file",value:"file",defaultChecked:"true",labels:{label:"Package XML"}}),s.default.createElement(e.Radio,{id:"metadata_group",value:"metadata_group",labels:{label:"Metadata groups"}}))),s.default.createElement(O,null,s.default.createElement("legend",{className:"slds-form-element__legend slds-form-element__label"},"Input"),"file"===D&&s.default.createElement(e.Input,{name:"packageFile",type:"file",inputRef:A,onChange:z}),"metadata_group"===D&&o.map((function(e,t){return s.default.createElement(j,{name:o[t].name,members:o[t].members.join(","),setName:G,setMembers:W,key:t,index:t})})),"metadata_group"===D&&s.default.createElement(e.Button,{onClick:q},"More"),"metadata_group"===D&&o.length>1&&s.default.createElement(e.Button,{onClick:Q},"Less")),s.default.createElement(O,null,s.default.createElement("legend",{className:"slds-form-element__legend slds-form-element__label"},"Parameters"),s.default.createElement(e.Input,{type:"text",placeholder:"Package names (comma sep)",onChange:function(e){return T(e.target.value.split(","))}}),s.default.createElement(e.Checkbox,{id:"singlePackage",labels:{label:"Single Package"},onChange:function(e,t){P(t.checked)},checked:_})),s.default.createElement(e.Button,{onClick:F},"Retrieve"),s.default.createElement(e.Button,{onClick:H},"Clear"),E&&!k&&s.default.createElement(e.Button,{onClick:L},"Fetch Zip"),k&&s.default.createElement("a",{download:!0,href:"data:application/zip;base64,".concat(k)},"Download")))},B=i.default.div(g||(g=m(["\n  color: green;\n"],["\n  color: green;\n"]))),T=function(n){var a=n.setErrorMessage,l=n.setDescribeResponse,r=n.sid,u=n.soapEndpoint,i=n.sendDeploy,o=n.sendDeployStatus,c=n.sendRetrieve,d=n.sendRetrieveStatus,f=n.apiVersion,p=t.useState(),m=p[0],b=p[1];return s.default.createElement("div",null,m&&s.default.createElement(B,null,m),s.default.createElement(e.Tabs,null,s.default.createElement(e.TabsPanel,{label:"Retrieve"},s.default.createElement(I,{sid:r,soapEndpoint:u,sendRetrieve:c,sendRetrieveStatus:d,apiVersion:f,setErrorMessage:a,setDescribeResponse:l,setObjectName:n.setObjectName,setStatus:b})),s.default.createElement(e.TabsPanel,{label:"Deploy"},s.default.createElement(R,{sid:r,soapEndpoint:u,sendDeploy:i,sendDeployStatus:o,setErrorMessage:a,setDescribeResponse:l,setStatus:b,setObjectName:n.setObjectName}))))},w=function(n){var a=n.setDescribeResponse,l=n.setErrorMessage,r=t.useState(""),i=r[0],o=r[1],p=t.useState({}),m=p[0],b=p[1],v=t.useState(""),g=v[0],h=v[1],E=t.useState(),y=E[0],S=E[1],k=t.useState({}),C=k[0],R=k[1],O=t.useCallback((function(){return d(void 0,void 0,void 0,(function(){var e,t,r,s;return f(this,(function(o){switch(o.label){case 0:l(""),a(void 0),b({}),R({}),u.default.start(),o.label=1;case 1:return o.trys.push([1,4,5,6]),[4,n.describeObject({object:g,apiVersion:n.apiVersion,sfdcBaseUrl:n.sfdcBaseUrl})];case 2:return e=o.sent(),t=e.fields.map((function(e){return[e.name,{type:e.type,readonly:!e.updateable,values:e.picklistValues.map((function(e){return{label:e.label}}))}]})),S(Object.fromEntries(t)),[4,n.sendRest({apiVersion:n.apiVersion,sfdcBaseUrl:n.sfdcBaseUrl,endpoint:"/services/data/v55.0/sobjects/".concat(g,"/").concat(i)})];case 3:return r=o.sent(),b(r),[3,6];case 4:return s=o.sent(),l(s instanceof Error?s.message:s+""),[3,6];case 5:return u.default.done(),[7];case 6:return[2]}}))}))}),[i,n.sfdcBaseUrl,n.apiVersion,g]),j=t.useCallback((function(e,t,n){return d(void 0,void 0,void 0,(function(){var a,l,r;return f(this,(function(s){return(a=t||e.target.labels&&e.target.labels[0].innerText||"")&&(l=c({},m),r=c({},C),l[a]=n||e.target.value,r[a]=n||e.target.value,b(l),R(r)),[2]}))}))}),[m,C]),I=t.useCallback((function(){return d(void 0,void 0,void 0,(function(){var e;return f(this,(function(t){switch(t.label){case 0:u.default.start(),t.label=1;case 1:return t.trys.push([1,3,4,6]),[4,n.updateRecord({apiVersion:n.apiVersion,sfdcBaseUrl:n.sfdcBaseUrl,objectId:i,objectName:g,body:JSON.stringify(C),verb:"patch"})];case 2:return t.sent(),[3,6];case 3:return e=t.sent(),l(e instanceof Error?e.message:e+""),[3,6];case 4:return[4,O()];case 5:return t.sent(),R({}),u.default.done(),[7];case 6:return[2]}}))}))}),[n.apiVersion,n.sfdcBaseUrl,g,C]),B=t.useCallback((function(e){return y[e[0]].type}),[y]),T=t.useCallback((function(e){return e[1]}),[y]),w=t.useCallback((function(e){return e[0]}),[y]),_=t.useCallback((function(e){return y[e[0]].readonly}),[y]),P=t.useCallback((function(e){return y[e[0]].values}),[y]);return s.default.createElement(e.IconSettings,{iconPath:"/assets/icons"},s.default.createElement(e.Input,{type:"text",name:"entity-type",placeholder:"Entity Type",onChange:function(e){return h(e.target.value)}}),s.default.createElement(e.Input,{type:"text",name:"record-id",placeholder:"Record ID",onChange:function(e){return o(e.target.value)}}),s.default.createElement(e.Button,{onClick:O},"Fetch Record"),Object.keys(C).length>0&&s.default.createElement(e.Button,{onClick:I},"Save"),Object.entries(m).filter((function(e){return"attributes"!==e[0]&&!["reference","address"].includes(B(e))})).map((function(e){return s.default.createElement(x,{key:w(e),type:B(e),value:T(e),label:w(e),disabled:_(e),onChange:j,options:P(e)})})),Object.keys(C).length>0&&s.default.createElement(e.Button,{onClick:I},"Save"))},_=i.default.div(h||(h=m(["\n  padding: 1em 0;\n"],["\n  padding: 1em 0;\n"]))),P=function(n){var a=n.setErrorMessage,l=n.setDescribeResponse,r=t.useState("/services/data/v".concat(n.apiVersion)),i=r[0],o=r[1],c=t.useState("get"),p=c[0],m=c[1],b=t.useState(""),v=b[0],g=b[1];t.useEffect((function(){o("/services/data/v".concat(n.apiVersion))}),[n.apiVersion]);var h=t.useCallback((function(){return d(void 0,void 0,void 0,(function(){var e,t;return f(this,(function(r){switch(r.label){case 0:u.default.start(),r.label=1;case 1:switch(r.trys.push([1,7,8,9]),e=void 0,p){case"get":case"head":case"delete":return[3,2];case"post":case"patch":case"put":return[3,4]}return[3,6];case 2:return[4,n.sendRest({endpoint:i,apiVersion:n.apiVersion,sfdcBaseUrl:n.sfdcBaseUrl,verb:p})];case 3:return e=r.sent(),[3,6];case 4:return[4,n.postRest({body:v,endpoint:i,apiVersion:n.apiVersion,sfdcBaseUrl:n.sfdcBaseUrl,verb:p})];case 5:return e=r.sent(),[3,6];case 6:return l(e),[3,9];case 7:return t=r.sent(),a(n.handleError(t)),[3,9];case 8:return u.default.done(),[7];case 9:return[2]}}))}))}),[i,p,v]);return s.default.createElement(e.IconSettings,{iconPath:"/assets/icons"},s.default.createElement(_,null,s.default.createElement("div",{className:"slds-text-title_bold slds-form-element__label"},"HTTP Method"),s.default.createElement(e.RadioGroup,{onChange:function(e){return m(e.target.value)},name:"Type",variant:"button-group",style:{border:0}},s.default.createElement(e.Radio,{id:"get",value:"get",defaultChecked:"true",labels:{label:"GET"}}),s.default.createElement(e.Radio,{id:"post",value:"post",labels:{label:"POST"}}),s.default.createElement(e.Radio,{id:"put",value:"put",labels:{label:"PUT"}}),s.default.createElement(e.Radio,{id:"patch",value:"patch",labels:{label:"PATCH"}}),s.default.createElement(e.Radio,{id:"delete",value:"delete",labels:{label:"DELETE"}}),s.default.createElement(e.Radio,{id:"head",value:"head",labels:{label:"HEAD"}}))),s.default.createElement(_,null,s.default.createElement("div",{className:"slds-text-title_bold slds-form-element__label"},"Endpoint"),s.default.createElement(e.Input,{type:"text",name:"rest",placeholder:"Rest Endpoint",value:i,onChange:function(e){return o(e.target.value)}})),["post","put","patch"].filter((function(e){return e===p})).length>0&&s.default.createElement(_,null,s.default.createElement("div",{className:"slds-text-title_bold slds-form-element__label"},"Payload"),s.default.createElement(e.Textarea,{onChange:function(e){return g(e.target.value)}})),s.default.createElement(e.Button,{onClick:h},"Send"))},N=i.default.div(E||(E=m(["\n    color: red;\n"],["\n    color: red;\n"]))),D=i.default.div(y||(y=m(["\n    text-align: center;\n    padding: 3em;\n    max-width: 500px;\n    margin: auto;\n"],["\n    text-align: center;\n    padding: 3em;\n    max-width: 500px;\n    margin: auto;\n"]))),V=function(n){var a=t.useState(""),l=a[0],r=a[1],i=t.useState(""),o=i[0],c=i[1],p=t.useState(""),m=p[0],b=p[1],v=t.useState(""),g=v[0],h=v[1],E=t.useState(""),y=E[0],S=E[1],k=t.useState("55.0"),C=k[0],R=k[1],x=t.useCallback((function(){return d(void 0,void 0,void 0,(function(){var e;return f(this,(function(t){switch(t.label){case 0:u.default.start(),t.label=1;case 1:return t.trys.push([1,6,7,8]),l?[4,n.signin(l,o,C)]:[3,3];case 2:return t.sent(),[3,5];case 3:return[4,n.login(m,g,o,C)];case 4:t.sent(),t.label=5;case 5:return[3,8];case 6:return e=t.sent(),S(e instanceof Error?e.message:e+""),[3,8];case 7:return u.default.done(),[7];case 8:return[2]}}))}))}),[l,o,m,g,C]);return s.default.createElement(D,null,s.default.createElement("h1",{className:"slds-text-title_caps slds-p-vertical_medium"},"Sign In"),y&&s.default.createElement(N,null,"Signin failed: ",y),s.default.createElement(e.Input,{className:"slds-p-around_xxx-small",type:"text",name:"username",placeholder:"Username",onChange:function(e){return b(e.target.value)}}),s.default.createElement(e.Input,{className:"slds-p-around_xxx-small",type:"password",name:"password",placeholder:"Password",onChange:function(e){return h(e.target.value)}}),s.default.createElement(e.Input,{className:"slds-p-around_xxx-small",type:"text",name:"sid",placeholder:"Session ID",onChange:function(e){return r(e.target.value)}}),s.default.createElement(e.Input,{className:"slds-p-around_xxx-small",type:"text",name:"base-url",placeholder:"Instance URL",onChange:function(e){return c(e.target.value)}}),s.default.createElement(e.Input,{className:"slds-p-around_xxx-small",type:"text",name:"api-version",placeholder:"API Version",onChange:function(e){return R(e.target.value)}}),s.default.createElement(e.Button,{onClick:x},"Sign In"))},U=function(n){var a=n.setErrorMessage,l=n.fetchObjects,r=n.objects,i=n.sid,o=n.apiVersion,c=n.sfdcBaseUrl,p=n.describeObject,m=n.handleError,b=n.runQuery,v=t.useState(),g=v[0],h=v[1],E=t.useState(),y=E[0],S=E[1],k=t.useState(),C=k[0],R=k[1],x=t.useState([]),O=x[0],j=x[1],I=t.useState(),B=I[0],T=I[1],w=t.useState(),_=w[0],P=w[1];t.useEffect((function(){i&&S(r.map((function(e,t){return{subTitle:e,label:e,id:t,type:"field"}})))}),[i,r]),t.useEffect((function(){if(O&&g){var e=O.map((function(e){return e.label})).join(", ");T("select ".concat(e," from ").concat(g))}else T("")}),[O,g]);var N=t.useCallback((function(e){return d(void 0,void 0,void 0,(function(){var t,n;return f(this,(function(l){switch(l.label){case 0:h(e),j([{subTitle:"Id",label:"Id",id:0,type:"field"}]),l.label=1;case 1:return l.trys.push([1,3,4,5]),u.default.start(),[4,p({object:e,apiVersion:o,sfdcBaseUrl:c})];case 2:return t=l.sent(),R(t.fields.map((function(e){return{value:e.name,label:e.name}}))),[3,5];case 3:return n=l.sent(),a(m(n)),[3,5];case 4:return u.default.done(),[7];case 5:return[2]}}))}))}),[o,c]),D=t.useCallback((function(){return d(void 0,void 0,void 0,(function(){var e,t,n;return f(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,3,4]),u.default.start(),[4,b({query:B,apiVersion:o,sfdcBaseUrl:c})];case 1:return e=l.sent(),t=e.records.map((function(e){return{fields:Object.entries(e).filter((function(e){return"string"==typeof e[1]||"boolean"==typeof e[1]})).map((function(e){return{name:e[0],value:e[1]+""}}))}})),P(t),[3,4];case 2:return n=l.sent(),a(n instanceof Error?n.message:n+""),[3,4];case 3:return u.default.done(),[7];case 4:return[2]}}))}))}),[B,o,c]);return s.default.createElement("div",null,s.default.createElement(e.Dropdown,{label:g||"Select an Object",type:"picklist",align:"left",iconCategory:"utility",iconName:"down",length:"10",iconPosition:"right",onOpen:l,onSelect:function(e){return N(e.label)},options:y}),s.default.createElement(e.Combobox,{id:"combobox-unique-id",menuItemVisibleLength:5,events:{onChange:function(e){T(null==e?void 0:e.target.value)},onSelect:function(e,t){j(t.selection)},onRequestRemoveSelectedOption:function(e,t){j(t.selection)}},labels:{label:"Query",placeholder:"SOQL Query - Choose Fields"},multiple:!0,options:C,value:B,selection:O}),s.default.createElement(e.Button,{onClick:D,label:"Query"}),s.default.createElement(e.Button,{onClick:function(){P(void 0),h(void 0),j([]),R(void 0)},label:"Clear"}),s.default.createElement("table",null,_&&_.length>0&&_[0].fields.map((function(e){return s.default.createElement("th",null,e.name)})),null==_?void 0:_.map((function(e,t){return s.default.createElement("tr",{key:t},e.fields.map((function(e){return s.default.createElement("td",null,e.value)})))}))))},M=i.default.div(S||(S=m(["\n    display: flex;\n    justify-content: space-around;\n    padding: 1em; \n"],["\n    display: flex;\n    justify-content: space-around;\n    padding: 1em; \n"]))),A=function(n){var a=t.useMemo((function(){var e;return null===(e=n.sid)||void 0===e?void 0:e.substring(0,15)}),[n.sid]);return s.default.createElement("div",null,s.default.createElement(e.BrandBand,{id:"brand-band-lightning-blue",className:"slds-p-around_small",theme:"lightning-blue"},s.default.createElement(M,{className:"slds-box slds-theme_default"},"Workbench App",n.sid&&s.default.createElement("div",null,"OrgId: ",a),n.sid&&s.default.createElement("div",null,"Url: ",n.sfdcBaseUrl),n.sid&&s.default.createElement(e.Button,{onClick:n.signout,label:"Sign Out"}))))},L=i.default.div(k||(k=m(["\n  color: red;\n"],["\n  color: red;\n"])));exports.Deploy=R,exports.InputElement=x,exports.Metadata=T,exports.RecordEditor=w,exports.RestExplorer=P,exports.Retrieve=I,exports.SOQL=U,exports.Signin=V,exports.Workbench=function(n){var a=require("react-json-view-ts").default,l=t.useState([]),r=l[0],i=l[1],c=t.useState(0),p=c[0],m=c[1],b=t.useState(""),v=b[0],g=b[1],h=t.useState(),E=h[0],y=h[1],S=t.useState(),k=S[0],C=S[1],R=t.useState(""),x=R[0],O=R[1],j=t.useState(n.api),I=j[0];j[1];var B=t.useState(n.sid),_=B[0];B[1];var N=t.useState(n.apiVersion),D=N[0];N[1];var M=t.useState(n.sfdcBaseUrl),F=M[0];M[1];var q=t.useState("".concat(n.sfdcBaseUrl,"/services/Soap/m/").concat(n.apiVersion)),Q=q[0];q[1],t.useEffect((function(){_&&(I.setAxiosAuthHeader(_),y(r.map((function(e){return{value:e,label:e}}))))}),[_,r,I]);var G=t.useCallback((function(e,t){return d(void 0,void 0,void 0,(function(){var n,a;return f(this,(function(l){switch(l.label){case 0:if(r&&0!==r.length)return[3,5];u.default.start(),l.label=1;case 1:return l.trys.push([1,3,4,5]),[4,I.describeGlobal({sfdcBaseUrl:t||F,apiVersion:e||D})];case 2:return(n=l.sent())&&n.sobjects&&i(n.sobjects.map((function(e){return e.name}))),[3,5];case 3:return a=l.sent(),g(I.handleError(a)),[3,5];case 4:return u.default.done(),[7];case 5:return[2]}}))}))}),[r,D,F,I]);t.useEffect((function(){F&&I.setAxiosBaseURL(F)}),[F,I]);var W=t.useCallback((function(e){return e.name!==x}),[x]),H=t.useCallback((function(e){return d(void 0,void 0,void 0,(function(){var t,n,a,l,r,s,i,o,c;return f(this,(function(d){switch(d.label){case 0:C(void 0),O(e),u.default.start(),d.label=1;case 1:return d.trys.push([1,3,4,5]),[4,I.describeObject({object:e,apiVersion:D,sfdcBaseUrl:F})];case 2:return t=d.sent(),n=Object.entries(t).filter((function(e){return"string"==typeof e[1]||"boolean"==typeof e[1]})),a=t.fields.map((function(e){return[e.name,e]})),l=t.childRelationships.map((function(e){return["".concat(e.childSObject,".").concat(e.field),e]})),r=t.recordTypeInfos.map((function(e){return[e.name,e]})),s=t.supportedScopes.map((function(e){return[e.label,e]})),i=t.actionOverrides.map((function(e){return[e.name,e]})),o={Attributes:Object.fromEntries(n),Fields:Object.fromEntries(a),"Child Relationships":Object.fromEntries(l),"Record Type Infos":Object.fromEntries(r),"Supported Scopes":Object.fromEntries(s),"Action Overrides":Object.fromEntries(i)},C(o),[3,5];case 3:return c=d.sent(),g(c instanceof Error?c.message:c+""),[3,5];case 4:return u.default.done(),[7];case 5:return[2]}}))}))}),[D]);return s.default.createElement(e.IconSettings,{iconPath:"/assets/icons"},s.default.createElement(o.default,null,s.default.createElement(A,{sid:_,sfdcBaseUrl:F,signout:I.signout}),s.default.createElement(L,null,v),_&&s.default.createElement(e.Tabs,{id:"tabs-example-default",selectedIndex:p,onSelect:function(e){m(e)}},s.default.createElement(e.TabsPanel,{label:"Standard and Custom Objects"},s.default.createElement(e.Dropdown,{label:"Objects",type:"picklist",align:"left",iconCategory:"utility",iconName:"down",length:"10",iconPosition:"right",onSelect:function(e){return H(e.value)},onOpen:G,options:E})),s.default.createElement(e.TabsPanel,{label:"SOQL Queries"},s.default.createElement(U,{runQuery:I.runQuery,handleError:I.handleError,setErrorMessage:g,fetchObjects:G,objects:r,sid:_,apiVersion:D,sfdcBaseUrl:F,describeObject:I.describeObject})),s.default.createElement(e.TabsPanel,{label:"Record Editor"},s.default.createElement(w,{updateRecord:I.updateRecord,setErrorMessage:g,setDescribeResponse:C,apiVersion:D,sfdcBaseUrl:F,describeObject:I.describeObject,sendRest:I.sendRest})),s.default.createElement(e.TabsPanel,{label:"Metadata"},s.default.createElement(T,{setObjectName:O,setErrorMessage:g,setDescribeResponse:C,sid:_,soapEndpoint:Q,apiVersion:D,sendDeploy:I.sendDeploy,sendDeployStatus:I.sendDeployStatus,sendRetrieve:I.sendRetrieve,sendRetrieveStatus:I.sendRetrieveStatus})),s.default.createElement(e.TabsPanel,{label:"Rest Explorer"},s.default.createElement(P,{setErrorMessage:g,setDescribeResponse:C,apiVersion:"",sfdcBaseUrl:"",handleError:I.handleError,sendRest:I.sendRest,postRest:I.postRest})))||s.default.createElement(V,{signin:I.signin,login:I.login}),k&&s.default.createElement(a,{name:x,shouldCollapse:W,src:k})))},exports.WorkbenchHeader=A;
//# sourceMappingURL=index.js.map
