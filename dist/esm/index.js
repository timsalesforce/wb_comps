import{Input as e,Checkbox as t,RadioGroup as n,Radio as r,Button as a,Combobox as l,IconSettings as s,Tabs as i,TabsPanel as o,Textarea as c,Dropdown as u,BrandBand as d}from"@salesforce/design-system-react";import m,{useState as p,useEffect as f,useCallback as v,useMemo as b}from"react";import g from"nprogress";import h from"styled-components";import E from"@salesforce/design-system-react/components/alert/container";var y=function(){return y=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},y.apply(this,arguments)};function k(e,t,n,r){return new(n||(n=Promise))((function(a,l){function s(e){try{o(r.next(e))}catch(e){l(e)}}function i(e){try{o(r.throw(e))}catch(e){l(e)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}o((r=r.apply(e,t||[])).next())}))}function R(e,t){var n,r,a,l,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function i(l){return function(i){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return s.label++,{value:l[1],done:!1};case 5:s.label++,r=l[1],l=[0];continue;case 7:l=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==l[0]&&2!==l[0])){s=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){s.label=l[1];break}if(6===l[0]&&s.label<a[1]){s.label=a[1],a=l;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(l);break}a[2]&&s.ops.pop(),s.trys.pop();continue}l=t.call(e,s)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}}function C(e,t,n){if(n||2===arguments.length)for(var r,a=0,l=t.length;a<l;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}function x(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var O,j,S,w,_,N,T,P,V=h.div(O||(O=x(["\n  padding: 1em 0;\n"],["\n  padding: 1em 0;\n"]))),D=function(l){var s=l.setErrorMessage,i=l.setDescribeResponse,o=l.setStatus,c=p(),u=c[0],d=c[1],b=p(),h=b[0],E=b[1],y=p(!1),C=y[0],x=y[1],O=p(!1),j=O[0],S=O[1],w=p(!1),_=w[0],N=w[1],T=p(!1),P=T[0],D=T[1],U=p(!1),I=U[0],B=U[1],M=p(!1),A=M[0],F=M[1],L=p(!1),Q=L[0],q=L[1],z=p(!1),H=z[0],W=z[1],G=p(),Z=G[0],J=G[1],X=p("NoTestRun"),K=X[0],Y=X[1],$=p(),ee=$[0],te=$[1];f((function(){if(u){o("Request pending, checking status again in 5s...");var e=setInterval((function(){g.start(),l.sendDeployStatus({id:u,includeDetails:!0,sessionId:l.sid,soapEndpoint:l.soapEndpoint}).then((function(t){t.result.done&&(o(void 0),clearInterval(e),i(t.result))})).catch((function(t){s(t.message),clearInterval(e)})).finally((function(){g.done()}))}),5e3)}}),[u]);var ne=v((function(e){return k(void 0,void 0,void 0,(function(){return R(this,(function(t){return E(e.target.files&&e.target.files[0]||void 0),[2]}))}))}),[]),re=v((function(){return k(void 0,void 0,void 0,(function(){var e,t,n;return R(this,(function(r){switch(r.label){case 0:i(void 0),s(""),e={zipFile:h,allowMissingFiles:C,autoUpdatePackage:j,ignoreWarnings:P,checkOnly:_,performRetrieve:I,purgeOnDelete:A,rollbackOnError:Q,singlePackage:H,runTests:Z,testLevel:K,soapEndpoint:l.soapEndpoint,sessionId:l.sid},r.label=1;case 1:return r.trys.push([1,3,4,5]),g.start(),[4,l.sendDeploy(e)];case 2:return t=r.sent(),d(t.result.id),i(t.result),[3,5];case 3:return n=r.sent(),s(n instanceof Error?n.message:n+""),[3,5];case 4:return g.done(),l.setObjectName("Deploy"),[7];case 5:return[2]}}))}))}),[h,C,j,P,_,I,A,Q,H,Z,K]),ae=v((function(){return k(void 0,void 0,void 0,(function(){return R(this,(function(e){return i(void 0),d(void 0),E(void 0),o(void 0),x(!1),S(!1),D(!1),N(!1),B(!1),F(!1),q(!1),W(!1),J([]),Y(""),ee.value="",[2]}))}))}),[ee]);return m.createElement("div",null,m.createElement(V,null,m.createElement("div",{className:"slds-text-title_bold slds-form-element__label"},"File"),m.createElement(e,{name:"zipFile",type:"file",inputRef:te,onChange:ne})),m.createElement(V,null,m.createElement("div",{className:"slds-text-title_bold slds-form-element__label"},"Parameters"),m.createElement(t,{id:"allowMissingFiles",labels:{label:"Allow Missing Files"},onChange:function(e,t){x(t.checked)},checked:C}),m.createElement(t,{id:"autoUpdatePackage",labels:{label:"Auto Update Package"},onChange:function(e,t){S(t.checked)},checked:j}),m.createElement(t,{id:"checkOnly",labels:{label:"Check Only"},onChange:function(e,t){N(t.checked)},checked:_}),m.createElement(t,{id:"ignoreWarnings",labels:{label:"Ignore Warnings"},onChange:function(e,t){D(t.checked)},checked:P}),m.createElement(t,{id:"performRetrieve",labels:{label:"Perform Retrieve"},onChange:function(e,t){B(t.checked)},checked:I}),m.createElement(t,{id:"purgeOnDelete",labels:{label:"Purge On Delete"},onChange:function(e,t){F(t.checked)},checked:A}),m.createElement(t,{id:"rollbackOnError",labels:{label:"Rollback On Error"},onChange:function(e,t){q(t.checked)},checked:Q}),m.createElement(t,{id:"singlePackage",labels:{label:"Single Package"},onChange:function(e,t){W(t.checked)},checked:H})),m.createElement(V,null,m.createElement("div",{className:"slds-text-title_bold slds-form-element__label"},"Testing"),m.createElement("div",{style:{display:"flex"}},m.createElement(n,{onChange:function(e){return Y(e.target.value)},name:"Test Level",style:{border:0}},m.createElement(r,{id:"NoTestRun",value:"NoTestRun",defaultChecked:"true",labels:{label:"None"}}),m.createElement(r,{id:"RunLocalTests",value:"RunLocalTests",labels:{label:"Run Local"}}),m.createElement(r,{id:"RunAllTestsInOrg",value:"RunAllTestsInOrg",labels:{label:"Run All"}}),m.createElement(r,{id:"RunSpecifiedTests",value:"RunSpecifiedTests",labels:{label:"Run Specified"}}))),K&&"RunSpecifiedTests"===K&&m.createElement(e,{type:"text",placeholder:"Run tests (comma separated)",onChange:function(e){return J(e.target.value.split(","))}})),h&&m.createElement(a,{onClick:re},"Deploy"),m.createElement(a,{onClick:ae},"Clear"))},U=function(t){var n=p(t.value),r=n[0],a=n[1],s=p([{label:t.value}]),i=s[0],o=s[1];f((function(){"boolean"==typeof t.value?o([{label:t.value+""}]):o([{label:t.value}])}),[t.value]);var c=v((function(e){return m.createElement(l,{events:{onSelect:function(e,n){t.onChange(e,t.label,n.selection[0].label),a(""),o(n.selection)}},labels:{label:t.label},value:r,selection:i,align:"left",iconCategory:"utility",iconName:"down",length:"10",iconPosition:"right",variant:"readonly",options:e})}),[t.label,r,i]);return m.createElement("div",{key:t.label},"picklist"===t.type&&c(t.options)||"boolean"===t.type&&c([{label:"true"},{label:"false"}])||m.createElement(e,{type:"text",value:t.value,label:t.label,disabled:t.disabled,onChange:function(e){return t.onChange(e)}}))},I=h.div(j||(j=x(["\n  padding: 1em 0;\n"],["\n  padding: 1em 0;\n"]))),B=function(t){var n=t.index,r=t.setName,a=t.setMembers;return m.createElement("div",null,m.createElement(e,{type:"text",name:"name",placeholder:"Metadata Type",value:t.name,onChange:function(e){return r(e.target.value,n)}}),m.createElement(e,{type:"text",name:"members",placeholder:"Members (comma separated)",value:t.members,onChange:function(e){return a(e.target.value,n)}}))},M=function(l){var i=l.setErrorMessage,o=l.setDescribeResponse,c=l.setStatus,u=p([{name:"",members:[]}]),d=u[0],b=u[1],h=p(),E=h[0],x=h[1],O=p(),j=O[0],S=O[1],w=p(),_=w[0],N=w[1],T=p();T[0];var P=T[1],V=p([]),D=V[0],U=V[1],M=p(!1),A=M[0],F=M[1],L=p("file"),Q=L[0],q=L[1],z=p(),H=z[0],W=z[1];f((function(){if(E){c("Request pending, checking status again in 5s...");var e=setInterval((function(){g.start(),l.sendRetrieveStatus({id:E,includeZip:!1,sessionId:l.sid,soapEndpoint:l.soapEndpoint}).then((function(t){t.result.done&&(c(void 0),clearInterval(e),S(!0),o(t.result))})).catch((function(t){i(t.message),clearInterval(e)})).finally((function(){g.done()}))}),5e3)}}),[E]);var G=v((function(){return k(void 0,void 0,void 0,(function(){var e;return R(this,(function(t){switch(t.label){case 0:return[4,l.sendRetrieveStatus({id:E,includeZip:!0,sessionId:l.sid,soapEndpoint:l.soapEndpoint})];case 1:return e=t.sent(),N(e.result.zipFile),[2]}}))}))}),[E]),Z=v((function(){return k(void 0,void 0,void 0,(function(){var e,t;return R(this,(function(n){switch(n.label){case 0:N(void 0),S(!1),o(void 0),n.label=1;case 1:return n.trys.push([1,3,4,5]),g.start(),[4,l.sendRetrieve({types:d,packageNames:D,singlePackage:A,sessionId:l.sid,soapEndpoint:l.soapEndpoint,apiVersion:l.apiVersion})];case 2:return e=n.sent(),x(e.result.id),o(e.result),[3,5];case 3:return t=n.sent(),i(t instanceof Error?t.message:t+""),[3,5];case 4:return g.done(),l.setObjectName("Retrieve"),[7];case 5:return[2]}}))}))}),[d,D,A]),J=v((function(){return k(void 0,void 0,void 0,(function(){var e;return R(this,(function(t){return(e=C([],d,!0)).push({name:"",members:[]}),b(e),[2]}))}))}),[d]),X=v((function(){return k(void 0,void 0,void 0,(function(){var e;return R(this,(function(t){return(e=C([],d,!0)).pop(),b(e),[2]}))}))}),[d]),K=v((function(e,t){return k(void 0,void 0,void 0,(function(){var n,r;return R(this,(function(a){return n=C([],d,!0),(r=y({},n[t])).name=e,n.splice(t,1,r),b(n),[2]}))}))}),[d]),Y=v((function(e,t){return k(void 0,void 0,void 0,(function(){var n,r;return R(this,(function(a){return n=C([],d,!0),(r=y({},n[t])).members=e.split(","),n.splice(t,1,r),b(n),[2]}))}))}),[d,l.soapEndpoint,l.sid,D]),$=v((function(){return k(void 0,void 0,void 0,(function(){return R(this,(function(e){return o(void 0),b([{name:"",members:[]}]),S(!1),x(void 0),N(void 0),c(void 0),P(void 0),H.value="",[2]}))}))}),[H]),ee=v((function(e){return k(void 0,void 0,void 0,(function(){var t,n,r,a;return R(this,(function(l){switch(l.label){case 0:return e.target.files&&e.target.files.length>0?(P(e.target.files[0]),t=[],[4,e.target.files[0].text()]):[3,2];case 1:return n=l.sent(),r=require("react-xml-parser"),a=(new r).parseFromString(n),a.getElementsByTagName("types").map((function(e){var n=e.getElementsByTagName("name")[0].value,r=e.getElementsByTagName("members").map((function(e){return e.value}));t.push({name:n,members:r})})),b(t),[3,3];case 2:b([]),l.label=3;case 3:return[2]}}))}))}),[]);return m.createElement("div",null,m.createElement(s,{iconPath:"/assets/icons"},m.createElement(I,null,m.createElement(n,{labels:{label:"Choose Input Type"},onChange:function(e){return q(e.target.value)},name:"Type"},m.createElement(r,{id:"file",value:"file",defaultChecked:"true",labels:{label:"Package XML"}}),m.createElement(r,{id:"metadata_group",value:"metadata_group",labels:{label:"Metadata groups"}}))),m.createElement(I,null,m.createElement("legend",{className:"slds-form-element__legend slds-form-element__label"},"Input"),"file"===Q&&m.createElement(e,{name:"packageFile",type:"file",inputRef:W,onChange:ee}),"metadata_group"===Q&&d.map((function(e,t){return m.createElement(B,{name:d[t].name,members:d[t].members.join(","),setName:K,setMembers:Y,key:t,index:t})})),"metadata_group"===Q&&m.createElement(a,{onClick:J},"More"),"metadata_group"===Q&&d.length>1&&m.createElement(a,{onClick:X},"Less")),m.createElement(I,null,m.createElement("legend",{className:"slds-form-element__legend slds-form-element__label"},"Parameters"),m.createElement(e,{type:"text",placeholder:"Package names (comma sep)",onChange:function(e){return U(e.target.value.split(","))}}),m.createElement(t,{id:"singlePackage",labels:{label:"Single Package"},onChange:function(e,t){F(t.checked)},checked:A})),m.createElement(a,{onClick:Z},"Retrieve"),m.createElement(a,{onClick:$},"Clear"),j&&!_&&m.createElement(a,{onClick:G},"Fetch Zip"),_&&m.createElement("a",{download:!0,href:"data:application/zip;base64,".concat(_)},"Download")))},A=h.div(S||(S=x(["\n  color: green;\n"],["\n  color: green;\n"]))),F=function(e){var t=e.setErrorMessage,n=e.setDescribeResponse,r=e.sid,a=e.soapEndpoint,l=e.sendDeploy,s=e.sendDeployStatus,c=e.sendRetrieve,u=e.sendRetrieveStatus,d=e.apiVersion,f=p(),v=f[0],b=f[1];return m.createElement("div",null,v&&m.createElement(A,null,v),m.createElement(i,null,m.createElement(o,{label:"Retrieve"},m.createElement(M,{sid:r,soapEndpoint:a,sendRetrieve:c,sendRetrieveStatus:u,apiVersion:d,setErrorMessage:t,setDescribeResponse:n,setObjectName:e.setObjectName,setStatus:b})),m.createElement(o,{label:"Deploy"},m.createElement(D,{sid:r,soapEndpoint:a,sendDeploy:l,sendDeployStatus:s,setErrorMessage:t,setDescribeResponse:n,setStatus:b,setObjectName:e.setObjectName}))))},L=function(t){var n=t.setDescribeResponse,r=t.setErrorMessage,l=p(""),i=l[0],o=l[1],c=p({}),u=c[0],d=c[1],f=p(""),b=f[0],h=f[1],E=p(),C=E[0],x=E[1],O=p({}),j=O[0],S=O[1],w=v((function(){return k(void 0,void 0,void 0,(function(){var e,a,l,s;return R(this,(function(o){switch(o.label){case 0:r(""),n(void 0),d({}),S({}),g.start(),o.label=1;case 1:return o.trys.push([1,4,5,6]),[4,t.describeObject({object:b,apiVersion:t.apiVersion,sfdcBaseUrl:t.sfdcBaseUrl})];case 2:return e=o.sent(),a=e.fields.map((function(e){return[e.name,{type:e.type,readonly:!e.updateable,values:e.picklistValues.map((function(e){return{label:e.label}}))}]})),x(Object.fromEntries(a)),[4,t.sendRest({apiVersion:t.apiVersion,sfdcBaseUrl:t.sfdcBaseUrl,endpoint:"/services/data/v55.0/sobjects/".concat(b,"/").concat(i)})];case 3:return l=o.sent(),d(l),[3,6];case 4:return s=o.sent(),r(s instanceof Error?s.message:s+""),[3,6];case 5:return g.done(),[7];case 6:return[2]}}))}))}),[i,t.sfdcBaseUrl,t.apiVersion,b]),_=v((function(e,t,n){return k(void 0,void 0,void 0,(function(){var r,a,l;return R(this,(function(s){return(r=t||e.target.labels&&e.target.labels[0].innerText||"")&&(a=y({},u),l=y({},j),a[r]=n||e.target.value,l[r]=n||e.target.value,d(a),S(l)),[2]}))}))}),[u,j]),N=v((function(){return k(void 0,void 0,void 0,(function(){var e;return R(this,(function(n){switch(n.label){case 0:g.start(),n.label=1;case 1:return n.trys.push([1,3,4,6]),[4,t.updateRecord({apiVersion:t.apiVersion,sfdcBaseUrl:t.sfdcBaseUrl,objectId:i,objectName:b,body:JSON.stringify(j),verb:"patch"})];case 2:return n.sent(),[3,6];case 3:return e=n.sent(),r(e instanceof Error?e.message:e+""),[3,6];case 4:return[4,w()];case 5:return n.sent(),S({}),g.done(),[7];case 6:return[2]}}))}))}),[t.apiVersion,t.sfdcBaseUrl,b,j]),T=v((function(e){return C[e[0]].type}),[C]),P=v((function(e){return e[1]}),[C]),V=v((function(e){return e[0]}),[C]),D=v((function(e){return C[e[0]].readonly}),[C]),I=v((function(e){return C[e[0]].values}),[C]);return m.createElement(s,{iconPath:"/assets/icons"},m.createElement(e,{type:"text",name:"entity-type",placeholder:"Entity Type",onChange:function(e){return h(e.target.value)}}),m.createElement(e,{type:"text",name:"record-id",placeholder:"Record ID",onChange:function(e){return o(e.target.value)}}),m.createElement(a,{onClick:w},"Fetch Record"),Object.keys(j).length>0&&m.createElement(a,{onClick:N},"Save"),Object.entries(u).filter((function(e){return"attributes"!==e[0]&&!["reference","address"].includes(T(e))})).map((function(e){return m.createElement(U,{key:V(e),type:T(e),value:P(e),label:V(e),disabled:D(e),onChange:_,options:I(e)})})),Object.keys(j).length>0&&m.createElement(a,{onClick:N},"Save"))},Q=h.div(w||(w=x(["\n  padding: 1em 0;\n"],["\n  padding: 1em 0;\n"]))),q=function(t){var l=t.setErrorMessage,i=t.setDescribeResponse,o=p("/services/data/v".concat(t.apiVersion)),u=o[0],d=o[1],b=p("get"),h=b[0],E=b[1],y=p(""),C=y[0],x=y[1];f((function(){d("/services/data/v".concat(t.apiVersion))}),[t.apiVersion]);var O=v((function(){return k(void 0,void 0,void 0,(function(){var e,n;return R(this,(function(r){switch(r.label){case 0:g.start(),r.label=1;case 1:switch(r.trys.push([1,7,8,9]),e=void 0,h){case"get":case"head":case"delete":return[3,2];case"post":case"patch":case"put":return[3,4]}return[3,6];case 2:return[4,t.sendRest({endpoint:u,apiVersion:t.apiVersion,sfdcBaseUrl:t.sfdcBaseUrl,verb:h})];case 3:return e=r.sent(),[3,6];case 4:return[4,t.postRest({body:C,endpoint:u,apiVersion:t.apiVersion,sfdcBaseUrl:t.sfdcBaseUrl,verb:h})];case 5:return e=r.sent(),[3,6];case 6:return i(e),[3,9];case 7:return n=r.sent(),l(t.handleError(n)),[3,9];case 8:return g.done(),[7];case 9:return[2]}}))}))}),[u,h,C]);return m.createElement(s,{iconPath:"/assets/icons"},m.createElement(Q,null,m.createElement("div",{className:"slds-text-title_bold slds-form-element__label"},"HTTP Method"),m.createElement(n,{onChange:function(e){return E(e.target.value)},name:"Type",variant:"button-group",style:{border:0}},m.createElement(r,{id:"get",value:"get",defaultChecked:"true",labels:{label:"GET"}}),m.createElement(r,{id:"post",value:"post",labels:{label:"POST"}}),m.createElement(r,{id:"put",value:"put",labels:{label:"PUT"}}),m.createElement(r,{id:"patch",value:"patch",labels:{label:"PATCH"}}),m.createElement(r,{id:"delete",value:"delete",labels:{label:"DELETE"}}),m.createElement(r,{id:"head",value:"head",labels:{label:"HEAD"}}))),m.createElement(Q,null,m.createElement("div",{className:"slds-text-title_bold slds-form-element__label"},"Endpoint"),m.createElement(e,{type:"text",name:"rest",placeholder:"Rest Endpoint",value:u,onChange:function(e){return d(e.target.value)}})),["post","put","patch"].filter((function(e){return e===h})).length>0&&m.createElement(Q,null,m.createElement("div",{className:"slds-text-title_bold slds-form-element__label"},"Payload"),m.createElement(c,{onChange:function(e){return x(e.target.value)}})),m.createElement(a,{onClick:O},"Send"))},z=h.div(_||(_=x(["\n    color: red;\n"],["\n    color: red;\n"]))),H=h.div(N||(N=x(["\n    text-align: center;\n    padding: 3em;\n    max-width: 500px;\n    margin: auto;\n"],["\n    text-align: center;\n    padding: 3em;\n    max-width: 500px;\n    margin: auto;\n"]))),W=function(t){var n=p(""),r=n[0],l=n[1],s=p(""),i=s[0],o=s[1],c=p(""),u=c[0],d=c[1],f=p(""),b=f[0],h=f[1],E=p(""),y=E[0],C=E[1],x=p("55.0"),O=x[0],j=x[1],S=v((function(){return k(void 0,void 0,void 0,(function(){var e;return R(this,(function(n){switch(n.label){case 0:g.start(),n.label=1;case 1:return n.trys.push([1,6,7,8]),r?[4,t.signin(r,i,O)]:[3,3];case 2:return n.sent(),[3,5];case 3:return[4,t.login(u,b,i,O)];case 4:n.sent(),n.label=5;case 5:return[3,8];case 6:return e=n.sent(),C(e instanceof Error?e.message:e+""),[3,8];case 7:return g.done(),[7];case 8:return[2]}}))}))}),[r,i,u,b,O]);return m.createElement(H,null,m.createElement("h1",{className:"slds-text-title_caps slds-p-vertical_medium"},"Sign In"),y&&m.createElement(z,null,"Signin failed: ",y),m.createElement(e,{className:"slds-p-around_xxx-small",type:"text",name:"username",placeholder:"Username",onChange:function(e){return d(e.target.value)}}),m.createElement(e,{className:"slds-p-around_xxx-small",type:"password",name:"password",placeholder:"Password",onChange:function(e){return h(e.target.value)}}),m.createElement(e,{className:"slds-p-around_xxx-small",type:"text",name:"sid",placeholder:"Session ID",onChange:function(e){return l(e.target.value)}}),m.createElement(e,{className:"slds-p-around_xxx-small",type:"text",name:"base-url",placeholder:"Instance URL",onChange:function(e){return o(e.target.value)}}),m.createElement(e,{className:"slds-p-around_xxx-small",type:"text",name:"api-version",placeholder:"API Version",onChange:function(e){return j(e.target.value)}}),m.createElement(a,{onClick:S},"Sign In"))},G=function(e){var t=e.setErrorMessage,n=e.fetchObjects,r=e.objects,s=e.sid,i=e.apiVersion,o=e.sfdcBaseUrl,c=e.describeObject,d=e.handleError,b=e.runQuery,h=p(),E=h[0],y=h[1],C=p(),x=C[0],O=C[1],j=p(),S=j[0],w=j[1],_=p([]),N=_[0],T=_[1],P=p(),V=P[0],D=P[1],U=p(),I=U[0],B=U[1];f((function(){s&&O(r.map((function(e,t){return{subTitle:e,label:e,id:t,type:"field"}})))}),[s,r]),f((function(){if(N&&E){var e=N.map((function(e){return e.label})).join(", ");D("select ".concat(e," from ").concat(E))}else D("")}),[N,E]);var M=v((function(e){return k(void 0,void 0,void 0,(function(){var n,r;return R(this,(function(a){switch(a.label){case 0:y(e),T([{subTitle:"Id",label:"Id",id:0,type:"field"}]),a.label=1;case 1:return a.trys.push([1,3,4,5]),g.start(),[4,c({object:e,apiVersion:i,sfdcBaseUrl:o})];case 2:return n=a.sent(),w(n.fields.map((function(e){return{value:e.name,label:e.name}}))),[3,5];case 3:return r=a.sent(),t(d(r)),[3,5];case 4:return g.done(),[7];case 5:return[2]}}))}))}),[i,o]),A=v((function(){return k(void 0,void 0,void 0,(function(){var e,n,r;return R(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,3,4]),g.start(),[4,b({query:V,apiVersion:i,sfdcBaseUrl:o})];case 1:return e=a.sent(),n=e.records.map((function(e){return{fields:Object.entries(e).filter((function(e){return"string"==typeof e[1]||"boolean"==typeof e[1]})).map((function(e){return{name:e[0],value:e[1]+""}}))}})),B(n),[3,4];case 2:return r=a.sent(),t(r instanceof Error?r.message:r+""),[3,4];case 3:return g.done(),[7];case 4:return[2]}}))}))}),[V,i,o]);return m.createElement("div",null,m.createElement(u,{label:E||"Select an Object",type:"picklist",align:"left",iconCategory:"utility",iconName:"down",length:"10",iconPosition:"right",onOpen:n,onSelect:function(e){return M(e.label)},options:x}),m.createElement(l,{id:"combobox-unique-id",menuItemVisibleLength:5,events:{onChange:function(e){D(null==e?void 0:e.target.value)},onSelect:function(e,t){T(t.selection)},onRequestRemoveSelectedOption:function(e,t){T(t.selection)}},labels:{label:"Query",placeholder:"SOQL Query - Choose Fields"},multiple:!0,options:S,value:V,selection:N}),m.createElement(a,{onClick:A,label:"Query"}),m.createElement(a,{onClick:function(){B(void 0),y(void 0),T([]),w(void 0)},label:"Clear"}),m.createElement("table",null,I&&I.length>0&&I[0].fields.map((function(e){return m.createElement("th",null,e.name)})),null==I?void 0:I.map((function(e,t){return m.createElement("tr",{key:t},e.fields.map((function(e){return m.createElement("td",null,e.value)})))}))))},Z=h.div(T||(T=x(["\n    display: flex;\n    justify-content: space-around;\n    padding: 1em; \n"],["\n    display: flex;\n    justify-content: space-around;\n    padding: 1em; \n"]))),J=function(e){var t=b((function(){var t;return null===(t=e.sid)||void 0===t?void 0:t.substring(0,15)}),[e.sid]);return m.createElement("div",null,m.createElement(d,{id:"brand-band-lightning-blue",className:"slds-p-around_small",theme:"lightning-blue"},m.createElement(Z,{className:"slds-box slds-theme_default"},"Workbench App",e.sid&&m.createElement("div",null,"OrgId: ",t),e.sid&&m.createElement("div",null,"Url: ",e.sfdcBaseUrl),e.sid&&m.createElement(a,{onClick:e.signout,label:"Sign Out"}))))},X=h.div(P||(P=x(["\n  color: red;\n"],["\n  color: red;\n"]))),K=function(e){var t=require("react-json-view-ts").default,n=p([]),r=n[0],a=n[1],l=p(0),c=l[0],d=l[1],b=p(""),h=b[0],y=b[1],C=p(),x=C[0],O=C[1],j=p(),S=j[0],w=j[1],_=p(""),N=_[0],T=_[1],P=p(e.api),V=P[0];P[1];var D=p(e.sid),U=D[0];D[1];var I=p(e.apiVersion),B=I[0];I[1];var M=p(e.sfdcBaseUrl),A=M[0];M[1];var Q=p("".concat(e.sfdcBaseUrl,"/services/Soap/m/").concat(e.apiVersion)),z=Q[0];Q[1],f((function(){U&&(V.setAxiosAuthHeader(U),O(r.map((function(e){return{value:e,label:e}}))))}),[U,r,V]);var H=v((function(e,t){return k(void 0,void 0,void 0,(function(){var n,l;return R(this,(function(s){switch(s.label){case 0:if(r&&0!==r.length)return[3,5];g.start(),s.label=1;case 1:return s.trys.push([1,3,4,5]),[4,V.describeGlobal({sfdcBaseUrl:t||A,apiVersion:e||B})];case 2:return(n=s.sent())&&n.sobjects&&a(n.sobjects.map((function(e){return e.name}))),[3,5];case 3:return l=s.sent(),y(V.handleError(l)),[3,5];case 4:return g.done(),[7];case 5:return[2]}}))}))}),[r,B,A,V]);f((function(){A&&V.setAxiosBaseURL(A)}),[A,V]);var Z=v((function(e){return e.name!==N}),[N]),K=v((function(e){return k(void 0,void 0,void 0,(function(){var t,n,r,a,l,s,i,o,c;return R(this,(function(u){switch(u.label){case 0:w(void 0),T(e),g.start(),u.label=1;case 1:return u.trys.push([1,3,4,5]),[4,V.describeObject({object:e,apiVersion:B,sfdcBaseUrl:A})];case 2:return t=u.sent(),n=Object.entries(t).filter((function(e){return"string"==typeof e[1]||"boolean"==typeof e[1]})),r=t.fields.map((function(e){return[e.name,e]})),a=t.childRelationships.map((function(e){return["".concat(e.childSObject,".").concat(e.field),e]})),l=t.recordTypeInfos.map((function(e){return[e.name,e]})),s=t.supportedScopes.map((function(e){return[e.label,e]})),i=t.actionOverrides.map((function(e){return[e.name,e]})),o={Attributes:Object.fromEntries(n),Fields:Object.fromEntries(r),"Child Relationships":Object.fromEntries(a),"Record Type Infos":Object.fromEntries(l),"Supported Scopes":Object.fromEntries(s),"Action Overrides":Object.fromEntries(i)},w(o),[3,5];case 3:return c=u.sent(),y(c instanceof Error?c.message:c+""),[3,5];case 4:return g.done(),[7];case 5:return[2]}}))}))}),[B]);return m.createElement(s,{iconPath:"/assets/icons"},m.createElement(E,null,m.createElement(J,{sid:U,sfdcBaseUrl:A,signout:V.signout}),m.createElement(X,null,h),U&&m.createElement(i,{id:"tabs-example-default",selectedIndex:c,onSelect:function(e){d(e)}},m.createElement(o,{label:"Standard and Custom Objects"},m.createElement(u,{label:"Objects",type:"picklist",align:"left",iconCategory:"utility",iconName:"down",length:"10",iconPosition:"right",onSelect:function(e){return K(e.value)},onOpen:H,options:x})),m.createElement(o,{label:"SOQL Queries"},m.createElement(G,{runQuery:V.runQuery,handleError:V.handleError,setErrorMessage:y,fetchObjects:H,objects:r,sid:U,apiVersion:B,sfdcBaseUrl:A,describeObject:V.describeObject})),m.createElement(o,{label:"Record Editor"},m.createElement(L,{updateRecord:V.updateRecord,setErrorMessage:y,setDescribeResponse:w,apiVersion:B,sfdcBaseUrl:A,describeObject:V.describeObject,sendRest:V.sendRest})),m.createElement(o,{label:"Metadata"},m.createElement(F,{setObjectName:T,setErrorMessage:y,setDescribeResponse:w,sid:U,soapEndpoint:z,apiVersion:B,sendDeploy:V.sendDeploy,sendDeployStatus:V.sendDeployStatus,sendRetrieve:V.sendRetrieve,sendRetrieveStatus:V.sendRetrieveStatus})),m.createElement(o,{label:"Rest Explorer"},m.createElement(q,{setErrorMessage:y,setDescribeResponse:w,apiVersion:"",sfdcBaseUrl:"",handleError:V.handleError,sendRest:V.sendRest,postRest:V.postRest})))||m.createElement(W,{signin:V.signin,login:V.login}),S&&m.createElement(t,{name:N,shouldCollapse:Z,src:S})))};export{D as Deploy,U as InputElement,F as Metadata,L as RecordEditor,q as RestExplorer,M as Retrieve,G as SOQL,W as Signin,K as Workbench,J as WorkbenchHeader};
//# sourceMappingURL=index.js.map
